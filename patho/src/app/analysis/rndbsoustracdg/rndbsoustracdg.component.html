<main class="container">

    <div class="row g-5">
        <div class="col-md-8">

            <div class="container bg-warning text-dark">
                <div class="row">
                    <div class="col-md-4">
                        <h3 class="pb-4 mb-4 fst-italic border-bottom">
                            Rerun Double Digital Substract
                        </h3>
                    </div>

                </div>
            </div>

            <div class="p-4 mb-1 bg-light rounded">
                <div>
                    <form [formGroup]="QcFormControl">
                        <mat-form-field appearance="fill" id="human">
                            <mat-label>Select Human reference</mat-label>
                            <mat-select formControlName="human" required>
                                <mat-option>--</mat-option>
                                <mat-option *ngFor="let human of ReferencehList" [value]="human">
                                    {{human}}
                                </mat-option>
                            </mat-select>
                            <mat-error *ngIf="QcFormControl.hasError('required')">Please choose Human references
                            </mat-error>
                            <mat-hint></mat-hint>
                        </mat-form-field>
                        &nbsp;&nbsp;&nbsp;
                        <mat-form-field appearance="fill" id="parasite">
                            <mat-label>Select Pathogene reference</mat-label>
                            <mat-select formControlName="parasite" required>
                                <mat-option>--</mat-option>
                                <mat-option *ngFor="let parasite of ReferencepList" [value]="parasite">
                                    {{parasite}}
                                </mat-option>
                            </mat-select>
                            <mat-error *ngIf="QcFormControl.hasError('required')">Please choose Pathogene
                                references
                            </mat-error>
                            <mat-hint></mat-hint>
                        </mat-form-field>
                    </form>
                </div>
                <div class="tab-content">

                    <mat-form-field>
                        <mat-label>Filter</mat-label>
                        <input matInput (keyup)="applyFilter($event)" placeholder="Ex. Mia" #input>
                    </mat-form-field>
                    <div class="container">
                        <div class="row">
                            <div class="col-6 col-sm-3">
                                <button mat-raised-button (click)="rerunDbs()" [disabled]="showlog"> Run </button>
                            </div>
                            <div class="col-6 col-sm-3">
                                <button mat-raised-button (click)="link()" [disabled]="showlog"> Results</button>
                            </div>
                            <div class="col-6 col-sm-3">

                                <div class="col-md-4 ms-auto" *ngIf="showlog">
                                    <mat-spinner [diameter]="40"></mat-spinner>
                                </div>
                            </div>

                            <!-- Force next columns to br<mat-spinner></mat-spinner>
eak to new line -->
                            <div class="w-100">
                                <hr>
                            </div>

                            <div class="col-6 col-sm-3">
                                <button mat-raised-button (click)="delete()" [disabled]="showlog"> Delete </button>
                            </div>
                            <div class="col-6 col-sm-3">
                                <button mat-raised-button [disabled]="showlog">
                                    <a target="_blank" (click)="linkdwn()" href="{{this.baseUrl}}/getconsole/">Download
                                        Log
                                    </a>
                                </button>
                            </div>
                            <div class="col-6 col-sm-3">
                                <button mat-raised-button [disabled] [ngStyle]="{'background-color':color}">
                                     Status
                                </button>
                            </div>
                           
                        </div>
                    </div>


                    <hr>
                    <div id="data" class="mat-elevation-z8">
                        <table mat-table [dataSource]="dataSource" matSort>
                            <ng-container matColumnDef="select">
                                <th mat-header-cell *matHeaderCellDef>
                                    <mat-checkbox (change)="$event ? masterToggle() : null"
                                        [checked]="selection.hasValue() && isAllSelected()"
                                        [indeterminate]="selection.hasValue() && !isAllSelected()"
                                        [aria-label]="checkboxLabel()">
                                    </mat-checkbox>
                                </th>
                                <td mat-cell *matCellDef="let row">
                                    <mat-checkbox (click)="$event.stopPropagation()"
                                        (change)="$event ? selection.toggle(row) : null"
                                        [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                                    </mat-checkbox>
                                </td>
                            </ng-container>
                            <!-- ID Column -->
                            <ng-container matColumnDef="name">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header> File Name </th>
                                <td mat-cell *matCellDef="let row"> {{row.fullname}} </td>
                            </ng-container>

                            <!-- Progress Column -->
                            <ng-container matColumnDef="url">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header> File Link </th>
                                <td mat-cell *matCellDef="let row"> {{row.url}} </td>
                            </ng-container>


                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

                            <!-- Row shown when there is no matching data. -->
                            <tr class="mat-row" *matNoDataRow>
                                <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
                            </tr>
                        </table>
                        <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
                    </div>
                </div>
            </div>

        </div>
        <div class="col-md-4">
            <div class="position-sticky" style="top: 2rem;">
                <div class="p-4 mb-3 bg-light rounded">
                    <h4 class="fst-italic">About</h4>
                    <p class="mb-0">samples of type pairends and extension fastq/fastq.gz are allowed.</p>
                    <div>
                        <hr>
                    </div>
                    <p class="mb-0">
                    <div class="mb-0">
                        <input type="file" multiple (change)="selectFiles($event)" />
                    </div>
                    <div class="modal-body">
                        <div *ngFor="let progressInfo of progressInfos" class="mb-2">
                            <span>{{ progressInfo.fileName }}</span>
                            <div class="progress">
                                <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar"
                                    attr.aria-valuenow="{{ progressInfo.value }}" aria-valuemin="0" aria-valuemax="100"
                                    [ngStyle]="{ width: progressInfo.value + '%' }">
                                    {{ progressInfo.value }}%
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">

                        <button type="button" class="btn btn-secondary" data-dismiss="modal"
                            (change)="getFolder()">Close</button>
                        <button type="button" class="btn btn-primary" [disabled]="!selectedFiles"
                            (click)="uploadFiles()">Upload</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

</main>